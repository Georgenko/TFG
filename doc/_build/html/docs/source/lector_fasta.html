
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>lector_fasta module &#8212; TFG  documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-lector_fasta">
<span id="lector-fasta-module"></span><h1>lector_fasta module<a class="headerlink" href="#module-lector_fasta" title="Permalink to this headline">¶</a></h1>
<p>module documentation</p>
<dl class="py class">
<dt id="lector_fasta.LectorFASTA">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">lector_fasta.</span></code><code class="sig-name descname"><span class="pre">LectorFASTA</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lector_fasta.LectorFASTA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Cada instancia representa un fichero FASTA cargado en memoria.</p>
<p>Los genomas en ficheros FASTA se representan en bytearray.
Los nuevas líneas se quitan.
Los bytes correspondientes a los nucleótidos A, C, G, N o T son los que
nos interesan y son por lo tanto los válidos.</p>
<dl class="py attribute">
<dt id="lector_fasta.LectorFASTA.contenido">
<code class="sig-name descname"><span class="pre">contenido</span></code><a class="headerlink" href="#lector_fasta.LectorFASTA.contenido" title="Permalink to this definition">¶</a></dt>
<dd><p>bytearray con los caracteres del fichero en bytes.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lector_fasta.LectorFASTA.bytes_validos">
<code class="sig-name descname"><span class="pre">bytes_validos</span></code><a class="headerlink" href="#lector_fasta.LectorFASTA.bytes_validos" title="Permalink to this definition">¶</a></dt>
<dd><p>Cantidad de bytes válidos en contenido.</p>
</dd></dl>

<dl class="py method">
<dt id="lector_fasta.LectorFASTA.buscar">
<code class="sig-name descname"><span class="pre">buscar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patron</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lector_fasta.LectorFASTA.buscar" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtiene las posiciones en el genoma donde aparece el patrón.</p>
<p>Primero creamos la lista vacía posiciones.
Luego, el patrón se convierte en letras mayúsculas
por si ha sido pasado con letras minúsculas.
Los caracteres del patrón se convierten en su código numérico.
A continuación empieza un bucle for sobre todos los caracteres del
genoma menos los últimos len(patron) para que no se salga del “array”.
En cada iteración se llama a comparar para comprobar
si el patrón coincide en alguna posición del genoma.
Si es el caso, se agrega esta posición a la lista posiciones.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>patron</strong> – El patrón que buscamos en el fichero de genoma.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>La lista con las posiciones donde el patrón aparece en el genoma.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lector_fasta.LectorFASTA.comparar">
<code class="sig-name descname"><span class="pre">comparar</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patron</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">posicion</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lector_fasta.LectorFASTA.comparar" title="Permalink to this definition">¶</a></dt>
<dd><p>Comprueba si el patrón coincide con un trozo del genoma.</p>
<p>El trozo de genoma empieza en la posición posicion.
Se comparan byte por byte el patrón y el trozo y si no coinciden,
se devuelve false.
Si coinciden, se devuelve true.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>posicion</strong> – La posición inicial del trozo.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True o False dependiendo de si el patrón coincide con el trozo.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lector_fasta.LectorFASTA.get_secuencia">
<code class="sig-name descname"><span class="pre">get_secuencia</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">posicion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tamano</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lector_fasta.LectorFASTA.get_secuencia" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtiene un trozo específico del genoma entero.</p>
<p>El genoma se carga en memoria como un “array”.
Con este método se obtiene el trozo de ese array que empieza en posicion
y es de longitud tamano.</p>
<p>Se utiliza en la parte final de main.py para imprimir qué trozos y
dónde han coincidido con el patrón.
Es útil, si el patrón buscado tiene N, por ejemplo GATNACA.
En este caso se imprimirán todos los trozos GATAACA, GATCACA, GATGACA
y GATTACA que hay en el genoma.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>posicion</strong> – La posición a partir de la cual extraer el trozo.</p></li>
<li><p><strong>tamano</strong> – Tamaño del trozo que se quiere extraer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>El trozo de longitud tamano que empieza en posicion.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lector_fasta.LectorFASTA.leer_fichero">
<code class="sig-name descname"><span class="pre">leer_fichero</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lector_fasta.LectorFASTA.leer_fichero" title="Permalink to this definition">¶</a></dt>
<dd><p>Carga en memoria los nucleótidos y su cantidad.</p>
<p>f=file
l=line
b=byte</p>
<p>El fichero se “abre” con open en modo read.</p>
<p>Primero se comprueba si el fichero caberá en memoria.
Esto se consigue posicionándose al final del fichero con seek,
y ver cuántos bytes ocupa. Luego se compara con el máximo posible
del sistema en el que se ejecuta el código.
Nota: se tienen en cuenta también los caracteres de nueva línea.</p>
<p>Luego creamos un bytearray vacío y un contador de bytes leídos nulo.
A continuación se “lee” cada línea del fichero en bucle.
A cada una se le quita la nueva línea con rstrip.
Las letras se convierten en mayúsculas con upper.
Si la línea es vacía, se pasa a la siguiente.
Se coge la longitud de esa línea con len.
Los caracteres se convierten en sus códigos numéricos/bytes con encode.
Cada uno de estos se añade al final de contenido.
El contador de bytes leídos se actualiza en cada iteración de línea
procesada.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> – El path del fichero FASTA a cargar.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Una instancia BytesLeidos con el contenido del fichero y los
bytes leídos que representan los bytes válidos.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">TFG</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Georgi Mihaylov.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/docs/source/lector_fasta.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>